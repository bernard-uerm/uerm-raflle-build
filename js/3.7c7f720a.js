(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"49c9":function(t,e,a){"use strict";a("bc7e")},b079:function(t,e,a){},bc7e:function(t,e,a){},c8da:function(t,e,a){},ca6a:function(t,e,a){"use strict";a("b079")},d55a:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"flex flex-center",staticStyle:{"padding-top":"120px"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6 text-center q-pt-md"},[a("Categories",{attrs:{raffleStatus:this.raffleStatus}})],1),t.winnersStatus?a("div",{staticClass:"col-6 text-center q-pt-md"},[a("Winners",{attrs:{raffleStatus:this.raffleStatus}})],1):t._e()])])},r=[],i=(a("e6cf"),a("ded3")),n=a.n(i),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-mt-xl"},[a("q-card",{staticClass:"card-category text-white",staticStyle:{height:"400px"}},[a("q-card-section",{staticClass:"bg-red-6"},[a("div",{staticClass:"text-h4 text-weight-thin text-uppercase text-white"},[t._v("\n        "+t._s(t.raffleDetails.raffleName)+"\n      ")])]),a("q-form",{ref:"requestForm",staticClass:"q-gutter-xs"},[t.showLoading?a("q-card-section",{staticStyle:{height:"300px"}}):t._e(),a("transition",{attrs:{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showCard,expression:"showCard"}]},[t.showDrawCard?a("div",[a("q-card-section",{staticClass:"q-mt-lg"},[a("q-select",{ref:"categories",staticStyle:{"padding-bottom":"15px"},attrs:{dense:"","use-input":"","hide-selected":"","fill-input":"",label:"Categories","input-debounce":"0",options:t.drawCategoriesOptions,"lazy-rules":"",color:"red-6",rules:[function(t){return t&&t.length>0||"Please enter the category"}]},on:{filter:t.filterCategories},scopedSlots:t._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[t._v("\n                      No results\n                    ")])],1)]},proxy:!0}],null,!1,4053631375),model:{value:t.drawCategories,callback:function(e){t.drawCategories=e},expression:"drawCategories"}})],1),a("q-card-section",[a("q-input",{ref:"numberOfWinners",attrs:{type:"number",label:"Enter Number of Winners",color:"red-6",rules:[function(t){return t&&t.length>0||"Please enter the number of winners"}]},model:{value:t.drawNumbers,callback:function(e){t.drawNumbers=e},expression:"drawNumbers"}})],1),a("q-card-section",[a("p",{staticClass:"text-primary"},[a("q-badge",{staticClass:"text-h6",attrs:{outline:"",color:"orange",label:t.winners+"/"+t.expectedWinners+" Winners"}})],1)]),a("q-card-actions",{staticClass:"bg-red-6 q-pa-sm",attrs:{align:"center"}},[a("q-btn-group",{attrs:{push:""}},[this.raffleStatus?a("q-btn",{staticClass:"text-white",attrs:{push:"",color:"primary",icon:"fa fa-hand-paper",size:"md",label:"DRAW",disable:t.disableButton},on:{click:function(e){return t.draw()}}}):t._e(),this.raffleStatus?t._e():a("q-btn",{staticClass:"text-white",attrs:{push:"",color:"secondary",icon:"fa fa-trophy",size:"md",label:"WINNERS"},on:{click:function(e){return t.getWinners()}}}),a("q-btn",{staticClass:"text-white",attrs:{push:"",color:"negative",icon:"logout",size:"md",label:"BACK"},on:{click:function(e){return t.setInit()}}})],1)],1)],1):t._e()])]),a("q-inner-loading",{attrs:{showing:t.showLoading}},[a("q-spinner-cube",{attrs:{size:"xl",color:"red-6"}})],1),a("q-inner-loading",{staticStyle:{"padding-top":"-10px"},attrs:{showing:this.drawLoading}},[a("q-spinner-pie",{attrs:{size:"180px",color:"red-6"}}),a("h4",{staticClass:"text-black"},[t._v("LOADING WINNERS")])],1)],1)],1)],1)},l=[],c=(a("c975"),a("ddb0"),a("2f62")),d={props:["raffleStatus"],data(){return{drawCategories:null,drawCategoriesOptions:null,drawNumbers:null,showCard:!1,showLoading:!1,drawLoading:!1,showDrawCard:!0,drumRoll:a("e585"),winners:0,expectedWinners:0,raffleWinners:[],disableButton:!0}},computed:n()({},Object(c["b"])(["categories","currentWinners","raffleDetails","raffleEntries","finalRaffleEntryWinners"])),watch:{async drawCategories(t){null!==t&&null!==this.drawNumbers&&(this.disableButton=!1),this.getRaffleEntries()},drawNumbers(t){console.log(t),this.validateDraw(),null!==t&&(this.disableButton=!1),""===t&&(this.disableButton=!0)}},methods:{async validateDraw(){return Number(this.drawNumbers)>Number(this.raffleDetails.raffleExpectedWinners)?(this.disableButton=!0,!1):(this.disableButton=!1,!0)},async shuffleEntries(){const t=await this.$store.dispatch("shuffleRaffleEntries",this.drawNumbers);console.log(t)},async reShuffleEntries(){const t=await this.$store.dispatch("shuffleRaffleEntries",this.drawNumbers);console.log(t)},cardLoading(){this.showLoading=!0,setTimeout((()=>{this.showLoading=!1,this.showCard=!1,this.showCard=!0,this.expectedWinners=this.raffleDetails.raffleExpectedWinners,this.currentWinners.length>0&&(this.winners=this.currentWinners.length)}),3e3)},async setInit(){this.$router.push("/raffles")},filterCategories(t,e){e(""!==t?()=>{const e=t.toLowerCase();this.drawCategoriesOptions=this.categories.filter((t=>t.toLowerCase().indexOf(e)>-1))}:()=>{this.drawCategoriesOptions=this.categories})},async getRaffleEntries(){await this.$store.dispatch("getRaffleEntries",this.drawCategories)},async draw(){var t=new Audio(this.drumRoll);t.play();const e=await this.validateDraw();this.drawLoading=!0,e&&this.$refs.requestForm.validate().then((async e=>{if(e){this.raffleWinners.push(this.raffleEntries);const e=await this.shuffleEntries();if(console.log(e),this.finalRaffleEntryWinners.length>0){for(var a of this.finalRaffleEntryWinners)a.entry_id=a.user_code,a.raffle_id=this.raffleDetails.raffleID;var s=await this.$store.dispatch("saveRaffleWinners",this.finalRaffleEntryWinners);console.log(s),this.getRaffleEntries()}void 0!==s.success&&setTimeout((()=>{this.drawLoading=!1,this.showDrawCard=!1,this.showDrawCard=!0,t.pause(),this.$router.push("/winners-list/"+this.raffleDetails.raffleID)}),5e3)}else this.formHasError=!0}))},async getWinners(){var t=new Audio(this.drumRoll);t.play(),this.drawLoading=!0,setTimeout((()=>{this.drawLoading=!1,this.showDrawCard=!1,this.showDrawCard=!0,t.pause(),this.$router.push("/winners-list/"+this.raffleDetails.raffleID)}),5e3)}},created(){this.cardLoading()}},f=d,h=(a("49c9"),a("2877")),u=a("f09f"),w=a("a370"),p=a("0378"),g=a("ddd8"),m=a("66e5"),C=a("4074"),b=a("27f9"),x=a("58a81"),v=a("4b7e"),y=a("e7a9"),D=a("9c40"),W=a("74f7"),S=a("a6a3"),_=a("163c"),q=a("eebe"),N=a.n(q),I=Object(h["a"])(f,o,l,!1,null,"48202221",null),E=I.exports;N()(I,"components",{QCard:u["a"],QCardSection:w["a"],QForm:p["a"],QSelect:g["a"],QItem:m["a"],QItemSection:C["a"],QInput:b["a"],QBadge:x["a"],QCardActions:v["a"],QBtnGroup:y["a"],QBtn:D["a"],QInnerLoading:W["a"],QSpinnerCube:S["a"],QSpinnerPie:_["a"]});var L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-mt-xl"},[a("form",[a("q-card",{staticClass:"card-category text-white card-border-primary",staticStyle:{"overflow-y":"auto",height:"532px"}},[a("q-card-section",[a("div",{staticClass:"text-h3 text-weight-thin text-red-6"},[t._v("\n          WINNERS OF "+t._s(t.raffleDetails.rafflePrize)+"\n        ")])]),a("transition",{attrs:{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showCard,expression:"showCard"}]},[t.showDrawCard?a("div",[a("div",{attrs:{id:"main"}},[a("q-card-section",{style:"animation-duration: "+this.overallDuration+";",attrs:{id:"scroller"}},[a("table",{staticClass:"winner-table",staticStyle:{"border-collapse":"collapse","font-size":"14px",width:"100%",border:"1px solid #f44336",color:"#f44336"},attrs:{border:this.tableBorder}},t._l(this.currentWinners,(function(e){return a("tr",t._b({key:e.entry_id},"tr",e,!1),[a("td",{staticClass:"text-center",attrs:{width:"11%"}},[t._v(t._s(e.incrementalID))]),a("td",{staticClass:"text-center",attrs:{width:"11%"}},[t._v(t._s(e.entry_id))]),a("td",{staticClass:"text-center",attrs:{width:"20%"}},[t._v(t._s(e.fullname))]),a("td",{staticClass:"text-center",attrs:{width:"20%"}},[t._v(t._s(e.department))]),a("td",{staticClass:"text-center",attrs:{width:"20%"}},[t._v(t._s(e.position))])])})),0)])],1)]):t._e()])]),a("q-inner-loading",{staticStyle:{"padding-top":"60px !important"},attrs:{showing:t.showLoading}},[a("q-spinner-pie",{attrs:{size:"180px",color:"red-6"}}),a("h3",{staticClass:"text-weight-thin text-red-6"},[t._v("LOADING WINNERS")])],1)],1)],1)])},R=[],O={name:"RaffleWinners",props:["raffleStatus"],data(){return{drawCategories:null,drawCategoriesOptions:null,drawNumbers:null,showCard:!1,showLoading:!1,drawLoading:!1,showDrawCard:!0,tableBorder:0,overallDuration:null,bgColor:"blue"}},computed:n()({},Object(c["b"])(["categories","currentWinners","raffleDetails","duration"])),watch:{duration(){this.computeDuration()}},methods:{cardLoading(){this.showLoading=!0,setTimeout((()=>{this.showLoading=!1,this.showCard=!1,this.showCard=!0}),3e3)},computeDuration(){var t=null;t=Number(this.duration<15)?Number(this.duration>2)&&Number(this.duration<10)?3:10:Number(this.duration>2)&&Number(this.duration<10)?5:Number(this.duration>=20)&&Number(this.duration<=30)?15:50,console.log(t),this.overallDuration=this.duration+t+"s"},filterCategories(t,e){e(""!==t?()=>{const e=t.toLowerCase();this.drawCategoriesOptions=this.categories.filter((t=>t.toLowerCase().indexOf(e)>-1))}:()=>{this.drawCategoriesOptions=this.categories})},async getWinners(){this.$router.push("/winners/"+this.drawCategories)}},created(){this.cardLoading(),this.computeDuration()}},Q=O,$=(a("fb58"),a("ca6a"),Object(h["a"])(Q,L,R,!1,null,"0c518858",null)),B=$.exports;N()($,"components",{QCard:u["a"],QCardSection:w["a"],QInnerLoading:W["a"],QSpinnerPie:_["a"]});var z={name:"RaffleDraw",components:{Categories:E,Winners:B},computed:n()({},Object(c["b"])(["raffleDetails","currentWinners","winnersStatus","duration"])),data(){return{raffleInfo:{raffleID:null,raffleName:null,rafflePrize:null,raffleExpectedWinners:null},raffleStatus:!0}},created(){this.getSpecificRaffle(),this.raffleInfo.raffleID=this.$route.params.id,this.getCategories(),this.getCurrentWinners()},methods:{async getSpecificRaffle(){const t=await this.$store.dispatch("getRaffles");if(t.length>0){const e=t.filter((t=>t.id==this.raffleInfo.raffleID));this.raffleInfo.raffleName=e[0].name,this.raffleInfo.rafflePrize=e[0].prize,this.raffleInfo.raffleExpectedWinners=e[0].expected_winners,await this.$store.dispatch("setRaffleDetails",this.raffleInfo)}},async getCategories(){await this.$store.dispatch("getCategories")},async getCurrentWinners(){await this.$store.dispatch("getCurrentWinners",this.raffleInfo.raffleID),this.currentWinners.length>=this.raffleDetails.raffleExpectedWinners?(this.raffleStatus=!1,await this.$store.dispatch("setRaffleStatus",!0)):(this.raffleStatus=!0,await this.$store.dispatch("setRaffleStatus",!1))}}},k=z,P=a("9989"),A=Object(h["a"])(k,s,r,!1,null,null,null);e["default"]=A.exports;N()(A,"components",{QPage:P["a"]})},e585:function(t,e,a){t.exports=a.p+"media/drum-roll.ac0fca02.mp3"},fb58:function(t,e,a){"use strict";a("c8da")}}]);