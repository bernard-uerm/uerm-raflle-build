(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{0:function(e,t){},2:function(e,t){},3:function(e,t){},"34ab":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"flex flex-center",staticStyle:{"padding-top":"150px"}},[a("div",{staticClass:"container q-ml-lg q-mr-lg"},[a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-12"},[a("q-card",{staticClass:"card-border-primary"},[a("q-card-section",[a("div",{staticClass:"text-h3 text-center text-weight-thin"},[e._v("UPLOAD EMPLOYEE (EXCEL) FILE")])]),a("q-card-section",[a("div",[a("input",{attrs:{type:"file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},on:{change:e.excelExport}})])]),a("q-card-actions",{staticClass:"row items-start q-gutter-md justify-center"},[a("q-btn",{attrs:{push:"",color:"primary"},on:{click:function(t){return e.saveEmployees()}}},[e._v("UPLOAD TO DATABASE")])],1)],1)],1)]),a("div",{staticClass:"row q-pa-md"},[a("div",{staticClass:"col-12"},[a("excel-export")],1)])])])},i=[],r=(a("e6cf"),a("ded3")),s=a.n(r),l=a("1146"),o=a.n(l),c=a("2f62"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-card",{staticClass:"card-border-primary"},[a("q-table",{attrs:{title:"Raffle Winners",data:e.setAllWinners,columns:e.columns,color:"primary","row-key":"incrementalID",loading:e.loading},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-btn-group",{attrs:{push:""}},[a("q-btn",{attrs:{push:"",color:"primary","icon-right":"archive",label:"Export to CSV","no-caps":""},on:{click:e.exportTable}}),a("q-btn",{attrs:{push:"",color:"primary","icon-right":"delete",label:"Clear Winners","no-caps":""},on:{click:e.clearWinners}})],1)]},proxy:!0}])})],1)],1)},p=[],m=a("a357");function u(e,t){let a=void 0!==t?t(e):e;return a=void 0===a||null===a?"":String(a),a=a.split('"').join('""'),`"${a}"`}var f={data(){return{loading:!1,columns:[{name:"entry_id",required:!0,label:"Employee ID",align:"left",field:e=>e.entry_id,sortable:!0},{name:"fullname",align:"center",label:"Full Name",field:"fullname"},{name:"department",label:"Department",field:"department"},{name:"position",label:"Position",field:"position"},{name:"category",label:"Category",field:"category"},{name:"raffle_price",label:"Prize",field:"prize"}]}},computed:s()({},Object(c["b"])(["setAllWinners"])),created(){this.getWinners()},methods:{async getWinners(){this.loading=!0,await this.$store.dispatch("getAllWinners"),this.loading=!1},exportTable(){const e=[this.columns.map((e=>u(e.label)))].concat(this.setAllWinners.map((e=>this.columns.map((t=>u("function"===typeof t.field?t.field(e):e[void 0===t.field?t.name:t.field],t.format))).join(",")))).join("\r\n"),t=Object(m["a"])("Winners.csv",e,"text/csv");!0!==t&&this.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},async clearWinners(){await this.$store.dispatch("clearWinners"),this.getWinners()}}},h=f,g=a("2877"),b=a("f09f"),y=a("eaac"),x=a("e7a9"),v=a("9c40"),E=a("eebe"),w=a.n(E),C=Object(g["a"])(h,d,p,!1,null,null,null),q=C.exports;w()(C,"components",{QCard:b["a"],QTable:y["a"],QBtnGroup:x["a"],QBtn:v["a"]});var W={name:"AdminConfiguration",components:{ExcelExport:q},data(){return{excelData:[],excelFormat:null,excelFormatParsed:null,employeeList:[]}},computed:s()({},Object(c["b"])(["raffleDetails","currentWinners","winnersStatus","duration"])),watch:{excelFormatParsed(e){this.employeeList=e}},methods:{excelExport(e){this.excelFormatParsed=null,this.excelEmailMessage=[];var t=event.target,a=new FileReader;a.readAsBinaryString(t.files[0]),a.onload=()=>{var e=a.result,t=o.a.read(e,{type:"binary"});t.SheetNames.forEach((e=>{var a=o.a.utils.sheet_to_json(t.Sheets.Sheet1);this.excelFormatParsed=a}))},setTimeout((()=>{this.excelEmailFormat=[],this.excelEmailFormatLoading=!1,this.showParsedEmailData=!0}),3e3)},async saveEmployees(){await this.$store.dispatch("saveEmployees",this.employeeList)}}},A=W,_=a("9989"),P=a("a370"),S=a("4b7e"),j=Object(g["a"])(A,n,i,!1,null,null,null);t["default"]=j.exports;w()(j,"components",{QPage:_["a"],QCard:b["a"],QCardSection:P["a"],QCardActions:S["a"],QBtn:v["a"]})}}]);