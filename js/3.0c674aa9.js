(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"1b5c":function(t,e,s){},9740:function(t,e,s){},"983f":function(t,e,s){},c546:function(t,e,s){"use strict";s("983f")},cbab:function(t,e,s){"use strict";s("9740")},d55a:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"flex flex-center",staticStyle:{"padding-top":"120px"}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-6 text-center q-pt-md"},[s("Categories",{attrs:{raffleStatus:this.raffleStatus}})],1),t.winnersStatus?s("div",{staticClass:"col-6 text-center q-pt-md"},[s("Winners",{attrs:{raffleStatus:this.raffleStatus}})],1):t._e()])])},r=[],i=(s("e6cf"),s("ded3")),n=s.n(i),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"q-mt-xl"},[s("q-card",{staticClass:"card-category text-white"},[s("q-card-section",{staticClass:"bg-red-6"},[s("div",{staticClass:"text-h3 text-weight-thin text-uppercase text-white"},[t._v("\n        "+t._s(t.raffleDetails.raffleName)+"\n      ")])]),s("q-form",{ref:"requestForm",staticClass:"q-gutter-xs"},[t.showLoading?s("q-card-section",{staticStyle:{height:"300px"}}):t._e(),s("transition",{attrs:{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showCard,expression:"showCard"}]},[t.showDrawCard?s("div",[s("q-card-section",{staticClass:"q-mt-lg"},[s("q-select",{ref:"categories",staticStyle:{"padding-bottom":"15px"},attrs:{dense:"","use-input":"","hide-selected":"","fill-input":"",label:"Categories","input-debounce":"0",options:t.drawCategoriesOptions,"lazy-rules":"",color:"red-6",rules:[function(t){return t&&t.length>0||"Please enter the category"}]},on:{filter:t.filterCategories},scopedSlots:t._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[t._v("\n                      No results\n                    ")])],1)]},proxy:!0}],null,!1,4053631375),model:{value:t.drawCategories,callback:function(e){t.drawCategories=e},expression:"drawCategories"}})],1),s("q-card-section",[s("q-input",{ref:"numberOfWinners",attrs:{type:"number",label:"Enter Number of Winners",color:"red-6",rules:[function(t){return t&&t.length>0||"Please enter the number of winners"}]},model:{value:t.drawNumbers,callback:function(e){t.drawNumbers=e},expression:"drawNumbers"}})],1),s("q-card-section",[s("p",{staticClass:"text-primary"},[s("q-badge",{staticClass:"text-h5",attrs:{outline:"",color:"orange",label:t.winners+"/"+t.expectedWinners+" Winners"}})],1)]),s("q-card-actions",{staticClass:"bg-red-6 q-pa-lg",attrs:{align:"center"}},[s("q-btn-group",{attrs:{push:""}},[this.raffleStatus?s("q-btn",{staticClass:"text-white",attrs:{push:"",color:"primary",icon:"book_online",size:"lg",label:"DRAW",disable:t.disableButton},on:{click:function(e){return t.draw()}}}):t._e(),this.raffleStatus?t._e():s("q-btn",{staticClass:"text-white",attrs:{push:"",color:"secondary",icon:"book_online",size:"lg",label:"WINNERS"},on:{click:function(e){return t.getWinners()}}}),s("q-btn",{staticClass:"text-white",attrs:{push:"",color:"negative",icon:"logout",size:"lg",label:"BACK"},on:{click:function(e){return t.setInit()}}})],1)],1)],1):t._e()])]),s("q-inner-loading",{attrs:{showing:t.showLoading}},[s("q-spinner-cube",{attrs:{size:"xl",color:"red-6"}})],1),s("q-inner-loading",{staticStyle:{"padding-top":"-10px"},attrs:{showing:this.drawLoading}},[s("q-spinner-pie",{attrs:{size:"180px",color:"red-6"}}),s("h4",{staticClass:"text-black"},[t._v("LOADING WINNERS")])],1)],1)],1)],1)},l=[],c=(s("c975"),s("ddb0"),s("2f62")),d={props:["raffleStatus"],data(){return{drawCategories:null,drawCategoriesOptions:null,drawNumbers:null,showCard:!1,showLoading:!1,drawLoading:!1,showDrawCard:!0,drumRoll:s("e585"),winners:0,expectedWinners:0,raffleWinners:[],disableButton:!1}},computed:n()({},Object(c["b"])(["categories","currentWinners","raffleDetails","raffleEntries","finalRaffleEntryWinners"])),watch:{async drawCategories(t){this.getRaffleEntries()},drawNumbers(t){this.validateDraw()}},methods:{async validateDraw(){return Number(this.drawNumbers)>Number(this.raffleDetails.raffleExpectedWinners)?(this.disableButton=!0,!1):(this.disableButton=!1,!0)},async shuffleEntries(){const t=await this.$store.dispatch("shuffleRaffleEntries",this.drawNumbers);console.log(t)},cardLoading(){this.showLoading=!0,setTimeout((()=>{this.showLoading=!1,this.showCard=!1,this.showCard=!0,this.expectedWinners=this.raffleDetails.raffleExpectedWinners,this.currentWinners.length>0&&(this.winners=this.currentWinners.length)}),3e3)},async setInit(){this.$router.push("/raffles")},filterCategories(t,e){e(""!==t?()=>{const e=t.toLowerCase();this.drawCategoriesOptions=this.categories.filter((t=>t.toLowerCase().indexOf(e)>-1))}:()=>{this.drawCategoriesOptions=this.categories})},async getRaffleEntries(){await this.$store.dispatch("getRaffleEntries",this.drawCategories)},async draw(){var t=new Audio(this.drumRoll);t.play();const e=await this.validateDraw();this.drawLoading=!0,e&&this.$refs.requestForm.validate().then((async e=>{if(e){this.raffleWinners.push(this.raffleEntries);const e=await this.shuffleEntries();if(console.log(e),this.finalRaffleEntryWinners.length>0){for(var s of this.finalRaffleEntryWinners)s.entry_id=s.user_code,s.raffle_id=this.raffleDetails.raffleID;var a=await this.$store.dispatch("saveRaffleWinners",this.finalRaffleEntryWinners);console.log(a),this.getRaffleEntries()}void 0!==a.success&&setTimeout((()=>{this.drawLoading=!1,this.showDrawCard=!1,this.showDrawCard=!0,t.pause(),this.$router.push("/winners-list/"+this.raffleDetails.raffleID)}),5e3)}else this.formHasError=!0}))},async getWinners(){var t=new Audio(this.drumRoll);t.play(),this.drawLoading=!0,setTimeout((()=>{this.drawLoading=!1,this.showDrawCard=!1,this.showDrawCard=!0,t.pause(),this.$router.push("/winners-list/"+this.raffleDetails.raffleID)}),5e3)}},created(){this.cardLoading(),console.log(this.currentWinners)}},f=d,h=(s("cbab"),s("2877")),u=s("f09f"),w=s("a370"),p=s("0378"),g=s("ddd8"),C=s("66e5"),m=s("4074"),b=s("27f9"),x=s("58a81"),v=s("4b7e"),y=s("e7a9"),W=s("9c40"),_=s("74f7"),D=s("a6a3"),q=s("163c"),S=s("eebe"),I=s.n(S),N=Object(h["a"])(f,o,l,!1,null,"52d72cfe",null),L=N.exports;I()(N,"components",{QCard:u["a"],QCardSection:w["a"],QForm:p["a"],QSelect:g["a"],QItem:C["a"],QItemSection:m["a"],QInput:b["a"],QBadge:x["a"],QCardActions:v["a"],QBtnGroup:y["a"],QBtn:W["a"],QInnerLoading:_["a"],QSpinnerCube:D["a"],QSpinnerPie:q["a"]});var E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"q-mt-xl"},[s("form",[s("q-card",{staticClass:"card-category text-white card-border-primary",staticStyle:{"overflow-y":"auto",height:"532px"}},[s("q-card-section",[s("div",{staticClass:"text-h3 text-weight-thin text-red-6"},[t._v("\n          WINNERS OF "+t._s(t.raffleDetails.rafflePrize)+"\n        ")])]),s("transition",{attrs:{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showCard,expression:"showCard"}]},[t.showDrawCard?s("div",[s("div",{attrs:{id:"main"}},[s("q-card-section",{style:"animation-duration: "+this.overallDuration+";",attrs:{id:"scroller"}},[s("table",{staticClass:"winner-table",staticStyle:{"border-collapse":"collapse","font-size":"14px",width:"100%",border:"1px solid #f44336",color:"#f44336"},attrs:{border:this.tableBorder}},t._l(this.currentWinners,(function(e){return s("tr",t._b({key:e.entry_id},"tr",e,!1),[s("td",{staticClass:"text-center",attrs:{width:"11%"}},[t._v(t._s(e.incrementalID))]),s("td",{staticClass:"text-center",attrs:{width:"11%"}},[t._v(t._s(e.entry_id))]),s("td",{staticClass:"text-center",attrs:{width:"20%"}},[t._v(t._s(e.fullname))]),s("td",{staticClass:"text-center",attrs:{width:"20%"}},[t._v(t._s(e.department))]),s("td",{staticClass:"text-center",attrs:{width:"20%"}},[t._v(t._s(e.position))])])})),0)])],1)]):t._e()])]),s("q-inner-loading",{staticStyle:{"padding-top":"60px !important"},attrs:{showing:t.showLoading}},[s("q-spinner-pie",{attrs:{size:"180px",color:"red-6"}}),s("h3",{staticClass:"text-weight-thin text-red-6"},[t._v("LOADING WINNERS")])],1)],1)],1)])},R=[],O={props:["raffleStatus"],data(){return{drawCategories:null,drawCategoriesOptions:null,drawNumbers:null,showCard:!1,showLoading:!1,drawLoading:!1,showDrawCard:!0,tableBorder:0,overallDuration:null,bgColor:"blue"}},computed:n()({},Object(c["b"])(["categories","currentWinners","raffleDetails","duration"])),methods:{cardLoading(){this.showLoading=!0;var t=null;t=Number(this.duration<15)?10:Number(this.duration>=20)&&Number(this.duration<=30)?15:50,this.overallDuration=this.duration+t+"s",setTimeout((()=>{this.showLoading=!1,this.showCard=!1,this.showCard=!0}),3e3)},filterCategories(t,e){e(""!==t?()=>{const e=t.toLowerCase();this.drawCategoriesOptions=this.categories.filter((t=>t.toLowerCase().indexOf(e)>-1))}:()=>{this.drawCategoriesOptions=this.categories})},async getWinners(){this.$router.push("/winners/"+this.drawCategories)}},created(){this.cardLoading(),console.log(this.currentWinners)}},Q=O,$=(s("de3d"),s("c546"),Object(h["a"])(Q,E,R,!1,null,"4e55576e",null)),k=$.exports;I()($,"components",{QCard:u["a"],QCardSection:w["a"],QInnerLoading:_["a"],QSpinnerPie:q["a"]});var z={components:{Categories:L,Winners:k},computed:n()({},Object(c["b"])(["raffleDetails","currentWinners","winnersStatus","duration"])),data(){return{raffleInfo:{raffleID:null,raffleName:null,rafflePrize:null,raffleExpectedWinners:null},raffleStatus:!0}},created(){this.getSpecificRaffle(),this.raffleInfo.raffleID=this.$route.params.id,this.getCategories(),this.getCurrentWinners()},methods:{async getSpecificRaffle(){const t=await this.$store.dispatch("getRaffles");if(t.length>0){const e=t.filter((t=>t.id==this.raffleInfo.raffleID));this.raffleInfo.raffleName=e[0].name,this.raffleInfo.rafflePrize=e[0].prize,this.raffleInfo.raffleExpectedWinners=e[0].expected_winners,await this.$store.dispatch("setRaffleDetails",this.raffleInfo)}},async getCategories(){await this.$store.dispatch("getCategories")},async getCurrentWinners(){await this.$store.dispatch("getCurrentWinners",this.raffleInfo.raffleID),this.currentWinners.length>=this.raffleDetails.raffleExpectedWinners?(this.raffleStatus=!1,await this.$store.dispatch("setRaffleStatus",!0)):(this.raffleStatus=!0,await this.$store.dispatch("setRaffleDetails",!1))}}},B=z,P=s("9989"),A=Object(h["a"])(B,a,r,!1,null,null,null);e["default"]=A.exports;I()(A,"components",{QPage:P["a"]})},de3d:function(t,e,s){"use strict";s("1b5c")},e585:function(t,e,s){t.exports=s.p+"media/drum-roll.ac0fca02.mp3"}}]);